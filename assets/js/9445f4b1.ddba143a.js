"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[48],{2963:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"module-05-rag/code-walkthrough","title":"Code Walkthrough","description":"Key components of the RAG implementation.","source":"@site/docs/module-05-rag/03-code-walkthrough.md","sourceDirName":"module-05-rag","slug":"/module-05-rag/code-walkthrough","permalink":"/docs/module-05-rag/code-walkthrough","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-05-rag/03-code-walkthrough.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3}}');var n=t(4848),c=t(8453);const o={sidebar_position:3},i="Code Walkthrough",a={},d=[{value:"Ingestion (<code>src/services/ingest.py</code>)",id:"ingestion-srcservicesingestpy",level:2},{value:"Vector Store (<code>src/services/vector_store.py</code>)",id:"vector-store-srcservicesvector_storepy",level:2},{value:"Retrieval (<code>src/services/retrieval.py</code>)",id:"retrieval-srcservicesretrievalpy",level:2},{value:"Chat Orchestration (<code>src/services/chat.py</code>)",id:"chat-orchestration-srcserviceschatpy",level:2}];function l(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"code-walkthrough",children:"Code Walkthrough"})}),"\n",(0,n.jsx)(r.p,{children:"Key components of the RAG implementation."}),"\n",(0,n.jsxs)(r.h2,{id:"ingestion-srcservicesingestpy",children:["Ingestion (",(0,n.jsx)(r.code,{children:"src/services/ingest.py"}),")"]}),"\n",(0,n.jsxs)(r.p,{children:["This service handles reading markdown files and chunking them. We use ",(0,n.jsx)(r.code,{children:"RecursiveCharacterTextSplitter"})," to ensure chunks are of appropriate size for the context window."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-python",children:"def chunk_markdown(content: str) -> List[Dict]:\n    # ... logic to split by headers and then by characters ...\n    return chunks\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"vector-store-srcservicesvector_storepy",children:["Vector Store (",(0,n.jsx)(r.code,{children:"src/services/vector_store.py"}),")"]}),"\n",(0,n.jsx)(r.p,{children:"We use Qdrant as our vector database. The client is initialized as a singleton."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-python",children:"class VectorStore:\n    @classmethod\n    def get_client(cls) -> QdrantClient:\n        # ... init client ...\n        return cls._client\n"})}),"\n",(0,n.jsxs)(r.h2,{id:"retrieval-srcservicesretrievalpy",children:["Retrieval (",(0,n.jsx)(r.code,{children:"src/services/retrieval.py"}),")"]}),"\n",(0,n.jsx)(r.p,{children:"We perform a semantic search using cosine similarity."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-python",children:'async def retrieve_context(query: str, top_k: int = 5):\n    embedding = await get_embedding(query)\n    search_result = client.search(\n        collection_name="book_content",\n        query_vector=embedding,\n        limit=top_k\n    )\n    return search_result\n'})}),"\n",(0,n.jsxs)(r.h2,{id:"chat-orchestration-srcserviceschatpy",children:["Chat Orchestration (",(0,n.jsx)(r.code,{children:"src/services/chat.py"}),")"]}),"\n",(0,n.jsx)(r.p,{children:"The chat service combines retrieval and generation. It constructs a prompt with the retrieved context and streams the response from Google Gemini."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-python",children:"async def process_chat_request(request: ChatRequest):\n    sources = await retrieve_context(request.query)\n    # ... construct system prompt with sources ...\n    async for chunk in generate_stream(user_prompt):\n        yield chunk\n"})})]})}function h(e={}){const{wrapper:r}={...(0,c.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>i});var s=t(6540);const n={},c=s.createContext(n);function o(e){const r=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(c.Provider,{value:r},e.children)}}}]);